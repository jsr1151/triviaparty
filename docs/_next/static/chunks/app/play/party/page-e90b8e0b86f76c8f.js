(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{721:(e,t,s)=>{Promise.resolve().then(s.bind(s,8586))},8586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s(5155),l=s(2115);function r(e){let{question:t,onAnswer:s}=e,[r,a]=(0,l.useState)(null),[i,c]=(0,l.useState)(null);return((0,l.useEffect)(()=>{if(a(null),c(null),Array.isArray(t.options)&&"string"==typeof t.correctAnswer)return void a({options:t.options,correctAnswer:t.correctAnswer});t.id&&fetch("/api/questions/details?id=".concat(t.id,"&type=multiple_choice")).then(e=>e.json()).then(a).catch(()=>{})},[t.id,t.options,t.correctAnswer]),r)?(0,n.jsx)("div",{className:"space-y-3",children:r.options.map(e=>(0,n.jsx)("button",{onClick:()=>{!i&&(c(e),s(e===r.correctAnswer))},className:"w-full text-left p-4 rounded-xl font-medium transition-colors\n            ".concat(null===i?"bg-gray-700 hover:bg-gray-600":e===r.correctAnswer?"bg-green-700":e===i?"bg-red-700":"bg-gray-700 opacity-50"),children:e},e))}):(0,n.jsx)("div",{className:"text-gray-400",children:"Loading options..."})}function a(e){let{question:t,onAnswer:s}=e,[r,a]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(a(null),c(""),d(!1),"string"==typeof t.answer)return void a({answer:t.answer,acceptedAnswers:Array.isArray(t.acceptedAnswers)?t.acceptedAnswers:[]});t.id&&fetch("/api/questions/details?id=".concat(t.id,"&type=open_ended")).then(e=>e.json()).then(a).catch(()=>{})},[t.id,t.answer,t.acceptedAnswers]),!r)return(0,n.jsx)("div",{className:"text-gray-400",children:"Loading..."});function u(){if(!r||o)return;d(!0);let e=e=>e.toLowerCase().trim();s([r.answer,...r.acceptedAnswers].some(t=>e(t)===e(i)))}return(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{value:i,onChange:e=>c(e.target.value),onKeyDown:e=>"Enter"===e.key&&u(),disabled:o,placeholder:"Type your answer...",className:"w-full bg-gray-700 text-white rounded-xl p-4 text-lg mb-4 focus:outline-none focus:ring-2 focus:ring-purple-500"}),!o&&(0,n.jsx)("button",{onClick:u,className:"w-full bg-purple-600 hover:bg-purple-500 py-3 rounded-xl font-bold",children:"Submit"}),o&&(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-700 rounded-xl",children:[(0,n.jsx)("div",{className:"text-sm text-gray-400",children:"Correct answer:"}),(0,n.jsx)("div",{className:"text-lg font-bold text-yellow-400",children:r.answer})]})]})}function i(e){let{question:t,onAnswer:s}=e,[r,a]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[o,d]=(0,l.useState)([]),[u,x]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(a(null),c(""),d([]),x(!1),Array.isArray(t.answers))return void a({answers:t.answers,minRequired:t.minRequired||1});t.id&&fetch("/api/questions/details?id=".concat(t.id,"&type=list")).then(e=>e.json()).then(a).catch(()=>{})},[t.id,t.answers,t.minRequired]),!r)return(0,n.jsx)("div",{className:"text-gray-400",children:"Loading..."});function m(){if(!r||!i.trim())return;let e=e=>e.toLowerCase().trim(),t=r.answers.find(t=>e(t)===e(i));t&&!o.includes(t)&&d(e=>[...e,t]),c("")}return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-sm text-gray-400 mb-3",children:["Find at least ",r.minRequired," of ",r.answers.length," answers"]}),(0,n.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,n.jsx)("input",{value:i,onChange:e=>c(e.target.value),onKeyDown:e=>"Enter"===e.key&&m(),disabled:u,placeholder:"Type an answer...",className:"flex-1 bg-gray-700 text-white rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,n.jsx)("button",{onClick:m,disabled:u,className:"bg-purple-600 hover:bg-purple-500 px-4 rounded-xl",children:"Add"})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:o.map(e=>(0,n.jsx)("span",{className:"bg-green-700 px-3 py-1 rounded-full text-sm",children:e},e))}),!u&&(0,n.jsxs)("button",{onClick:function(){x(!0),s(o.length>=((null==r?void 0:r.minRequired)||1))},className:"w-full bg-blue-600 hover:bg-blue-500 py-3 rounded-xl font-bold",children:["Done (",o.length,"/",r.answers.length,")"]}),u&&(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-700 rounded-xl",children:[(0,n.jsx)("div",{className:"text-sm text-gray-400 mb-2",children:"All answers:"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:r.answers.map(e=>(0,n.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat(o.includes(e)?"bg-green-700":"bg-gray-600"),children:e},e))})]})]})}function c(){var e;let[t,s]=(0,l.useState)([]),[c,o]=(0,l.useState)(0),[d,u]=(0,l.useState)(0),[x,m]=(0,l.useState)(null),[p,h]=(0,l.useState)(!0);function g(e){m(e),e&&u(e=>e+1)}if((0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/questions?limit=20");if(e.ok){let t=await e.json();if(Array.isArray(t.questions)&&t.questions.length>0)return void s(t.questions)}let t=await fetch("".concat("/triviaparty","/data/questions/sheets-import-questions.json"));if(!t.ok)return void s([]);let n=await t.json(),l=[...(Array.isArray(null==n?void 0:n.questions)?n.questions:[]).map((e,t)=>({...e,id:e.id||"static-".concat(t)}))].sort(()=>Math.random()-.5).slice(0,20);s(l)}catch(e){s([])}finally{h(!1)}})()},[]),p)return(0,n.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center text-white text-2xl",children:"Loading..."});if(0===t.length)return(0,n.jsx)("div",{className:"min-h-screen bg-gray-950 text-white flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-5xl mb-4",children:"\uD83C\uDF89"}),(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Party Mode"}),(0,n.jsx)("p",{className:"text-gray-400",children:"No questions available yet. Add questions to get started!"})]})});if(c>=t.length)return(0,n.jsx)("div",{className:"min-h-screen bg-gray-950 text-white flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFC6"}),(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Game Over!"}),(0,n.jsxs)("p",{className:"text-2xl text-yellow-400",children:["Score: ",d,"/",t.length]}),(0,n.jsx)("button",{onClick:()=>{o(0),u(0),m(null)},className:"mt-8 bg-purple-600 hover:bg-purple-500 px-8 py-3 rounded-xl font-bold text-xl",children:"Play Again"})]})});let f=t[c],y=("string"==typeof f.category?f.category:null==(e=f.category)?void 0:e.name)||f.type;return(0,n.jsx)("div",{className:"min-h-screen bg-gray-950 text-white p-8",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,n.jsxs)("span",{className:"text-gray-400",children:[c+1,"/",t.length]}),(0,n.jsxs)("span",{className:"text-yellow-400 font-bold",children:["Score: ",d]})]}),(0,n.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-8",children:[(0,n.jsx)("div",{className:"text-sm text-purple-400 mb-2 uppercase",children:y}),(0,n.jsx)("div",{className:"text-xl font-bold mb-6",children:f.question}),"multiple_choice"===f.type&&(0,n.jsx)(r,{question:f,onAnswer:g}),"open_ended"===f.type&&(0,n.jsx)(a,{question:f,onAnswer:g}),"list"===f.type&&(0,n.jsx)(i,{question:f,onAnswer:g}),!["multiple_choice","open_ended","list"].includes(f.type)&&(0,n.jsx)("div",{className:"text-gray-400 italic",children:'Question type "'.concat(f.type,'" viewer coming soon.')}),null!==x&&(0,n.jsx)("div",{className:"mt-4 text-center text-xl font-bold ".concat(x?"text-green-400":"text-red-400"),children:x?"✓ Correct!":"✗ Incorrect"}),null!==x&&(0,n.jsx)("button",{onClick:function(){o(e=>e+1),m(null)},className:"mt-6 w-full bg-purple-600 hover:bg-purple-500 py-3 rounded-xl font-bold text-xl",children:"Next →"})]})]})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=721)),_N_E=e.O()}]);